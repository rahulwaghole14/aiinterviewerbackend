import{G as te,r as a,h as re,u as ce,i as ie,a as i,s as c,j as s,k as J,l as G,m as ne,n as K,o as le,p as q}from"./index-DasKWjZg.js";import{T as oe}from"./ThemeToggle-A0cMapX0.js";import"./index-YPs6-RzR.js";function de(v){return te({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{fill:"none",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"32",d:"M368 368 144 144m224 0L144 368"},child:[]}]})(v)}const fe=({headerTitle:v,isSidebarExpanded:b,sidebarMobileOpen:D,onToggleSidebar:B,isMobile:p,onLogout:U,onProfileMenuItemClick:V,onMobileSidebarToggle:W})=>{const[t,d]=a.useState(""),[n,l]=a.useState([]),[f,T]=a.useState(!1),[X,j]=a.useState(!1),[h,N]=a.useState(!1),S=a.useRef(null),u=a.useRef(null),g=a.useRef(null),R=re(),Q=ce(),I=ie(),Y=()=>{switch(Q.pathname.split("/")[1]){case"candidates":return"Candidates";case"jobs":return"Jobs";case"hiring-agencies":return"Hiring Agencies";case"ai-interview-scheduler":return"Interview Scheduler";case"settings":return"Settings";case"interview-results":return"Interviews";default:return null}},y=i(e=>e.search?.searchTerm||""),P=i(e=>e.candidates?.allCandidates||[]),L=i(e=>e.jobs?.allJobs||[]),E=i(e=>e.jobs?.domains||[]),F=i(e=>e.hiringAgencies?.hiringAgencies||[]),O=i(e=>e.companies?.companies||[]),z=i(e=>e.recruiters?.recruiters||[]),A=i(e=>e.interviewSlots?.slots||[]),M=i(e=>e.interviews?.interviews||[]);a.useEffect(()=>{c.updateData("candidates",P),c.updateData("jobs",L),c.updateData("domains",E),c.updateData("hiringAgencies",F),c.updateData("companies",O),c.updateData("recruiters",z),c.updateData("interviewSlots",A),c.updateData("interviews",M)},[P.length,L.length,E.length,F.length,O.length,z.length,A.length,M.length]),a.useEffect(()=>{d(y)},[y]),a.useEffect(()=>{const e=r=>{S.current&&!S.current.contains(r.target)&&j(!1),u.current&&!u.current.contains(r.target)&&!f&&l([])};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[f]);const $=async e=>{const r=e.target.value;if(d(r),I(q(r)),r&&r.length>=2){N(!0);try{const k=localStorage.getItem("authToken");if(k){const m=["candidates","jobs","domains","hiringAgencies","companies","recruiters","interviewSlots","interviews"];try{const o=m.map(async ae=>await c.fetchDataIfNeeded(ae,k,!0));await Promise.all(o)}catch{}}const x=Y(),se=c.search(r,{limit:20}).sort((m,o)=>m.type===x&&o.type!==x?-1:o.type===x&&m.type!==x?1:o.relevance-m.relevance);l(se.slice(0,10))}catch{l([])}finally{N(!1)}}else l([]),N(!1)},Z=()=>{j(e=>!e)},H=e=>{j(!1),e==="logout"?U():V(e)},C=()=>{const e=!f;T(e),e?(d(y),setTimeout(()=>{g.current?.focus()},100)):(d(""),l([]))},w=e=>{e.detailPath&&e.type==="Candidates"?R(e.detailPath):R(e.path),T(!1),l([]),localStorage.setItem("searchHighlight",JSON.stringify({type:e.type,id:e.id,query:t,tab:e.tab||null}))},_=e=>{e.key==="Enter"&&t&&n.length>0&&w(n[0])},ee=()=>{d(""),l([]),I(q("")),u.current&&u.current.focus(),g.current&&g.focus()};return s.jsxs("div",{className:"header",children:[s.jsxs("div",{className:"header-left",children:[s.jsx("div",{className:"sidebar-toggle",onClick:p?W:B,title:p?D?"Close sidebar":"Open sidebar":b?"Collapse sidebar":"Expand sidebar",children:p?D?s.jsx(J,{size:20}):s.jsx(G,{size:20}):b?s.jsx(ne,{size:20}):s.jsx(G,{size:20})}),s.jsx("h1",{className:"header-title h2",children:v||"Dashboard"})," "]}),s.jsxs("div",{className:"header-right",children:[p?s.jsx("div",{className:"mobile-search-icon",onClick:e=>{e.preventDefault(),e.stopPropagation(),C()},children:s.jsx(K,{size:20})}):s.jsxs("div",{className:"header-search",ref:u,children:[s.jsx(K,{className:"search-icon"}),s.jsx("input",{type:"text",placeholder:"Search...",value:t,onChange:$,onKeyDown:_}),t&&s.jsx(J,{className:"clear-search-icon",size:18,style:{cursor:"pointer",marginLeft:"4px",color:"#aaa"},onClick:ee,title:"Clear search"}),t&&(h||n.length>0)&&s.jsx("div",{className:"search-dropdown",children:h?s.jsx("div",{className:"search-result-item search-loading",children:s.jsxs("div",{className:"search-result-content",children:[s.jsx("div",{className:"search-result-title",children:"Searching..."}),s.jsx("div",{className:"search-result-subtitle",children:"Fetching data from all components"})]})}):n.map((e,r)=>s.jsx("div",{className:"search-result-item",onClick:()=>w(e),children:s.jsxs("div",{className:"search-result-content",children:[s.jsxs("div",{className:"search-result-title",children:[e.title,s.jsx("span",{className:"search-result-type",children:e.type})]}),e.subtitle&&s.jsx("div",{className:"search-result-subtitle",children:e.subtitle}),e.description&&s.jsx("div",{className:"search-result-description",children:e.description})]})},`${e.type}-${e.id}`))})]}),f&&s.jsx("div",{className:"search-modal-overlay",onClick:C,children:s.jsxs("div",{className:"search-modal",onClick:e=>e.stopPropagation(),children:[s.jsxs("div",{className:"search-modal-header",children:[s.jsx("input",{type:"text",placeholder:"Search...",value:t,onChange:$,autoFocus:!0,ref:g}),s.jsx(de,{onClick:C,className:"close-search-modal"})]}),t&&(h||n.length>0)&&s.jsx("div",{className:"search-modal-results",children:h?s.jsx("div",{className:"search-result-item search-loading",children:s.jsxs("div",{className:"search-result-content",children:[s.jsx("div",{className:"search-result-title",children:"Searching..."}),s.jsx("div",{className:"search-result-subtitle",children:"Fetching data from all components"})]})}):n.map((e,r)=>s.jsx("div",{className:"search-result-item",onClick:()=>w(e),children:s.jsxs("div",{className:"search-result-content",children:[s.jsxs("div",{className:"search-result-title",children:[e.title,s.jsx("span",{className:"search-result-type",children:e.type})]}),e.subtitle&&s.jsx("div",{className:"search-result-subtitle",children:e.subtitle}),e.description&&s.jsx("div",{className:"search-result-description",children:e.description})]})},`${e.type}-${e.id}`))}),t&&!h&&n.length===0&&s.jsxs("p",{className:"no-results",children:['No results found for "',t,'"']}),!t&&s.jsx("p",{className:"no-results",children:"Start typing to search..."})]})}),s.jsx(oe,{variant:"button",showLabels:!1,className:"header-theme-toggle"}),s.jsxs("div",{className:"header-profile-wrapper",ref:S,children:[s.jsx("div",{className:"header-profile",onClick:Z,title:"Profile",children:s.jsx(le,{size:20})}),X&&s.jsxs("div",{className:"profile-context-menu",children:[s.jsx("div",{className:"menu-item",onClick:()=>H("profile"),children:"View Profile"}),s.jsx("div",{className:"menu-item logout",onClick:()=>H("logout"),children:"Logout"})]})]})]})]})};export{fe as default};
