import{h as be,i as je,P as ge,a as h,r as o,U as xe,V as ve,$ as Ce,j as s,a0 as Ne}from"./index-DasKWjZg.js";import{C as y}from"./CustomDropdown-CQFqCwwS.js";import"./index-YPs6-RzR.js";const x={NEW:"New",INTERVIEW_SCHEDULED:"Interview Scheduled",INTERVIEW_COMPLETED:"Interview Completed",EVALUATED:"Evaluated",REQUIRES_ACTION:"Requires Action",PENDING_SCHEDULING:"Pending Scheduling",BR_IN_PROCESS:"BR In Process",BR_EVALUATED:"BR Evaluated",INTERNAL_INTERVIEWS:"Internal Interviews",OFFERED:"Offered",HIRED:"Hired",REJECTED:"Rejected",OFFER_REJECTED:"Offer Rejected",CANCELLED:"Cancelled"},ae=["All","New","Interview Scheduled","Interview Completed","Evaluated","Requires Action","Pending Scheduling","BR In Process","BR Evaluated","Internal Interviews","Offered","Hired","Rejected","Offer Rejected","Cancelled"],Se=({candidate:i,onViewReport:f,getDomainName:F,getJobTitle:c})=>{const v=a=>{const r=x[a]||a;return["Requires Action","Pending Scheduling","BR In Process"].includes(r)?"badge-warning":["Rejected","Offer Rejected","Cancelled"].includes(r)?"badge-danger":["BR Evaluated","Internal Interviews","Offered","Hired","Interview Scheduled","Interview Completed","Evaluated"].includes(r)?"badge-success":"badge-info"},b=a=>{const r=x[a.status]||a.status;return r==="Interview Scheduled"&&a.interviewDetails?.date&&a.interviewDetails?.time?`Scheduled: ${a.interviewDetails.date} at ${a.interviewDetails.time}`:r==="Interview Completed"&&a.evaluation?.feedback?`Completed: ${a.evaluation.score}/10 - ${a.evaluation.result}`:r==="Evaluated"&&a.evaluation?.feedback?`Evaluated: ${a.evaluation.score}/10 - ${a.evaluation.result}`:r==="Pending Scheduling"&&a.interviewDetails?.date&&a.interviewDetails?.time?`Scheduled: ${a.interviewDetails.date} at ${a.interviewDetails.time}`:r==="BR Evaluated"&&a.evaluation?.feedback?`Evaluated: ${a.evaluation.score}/10 - ${a.evaluation.result}`:r==="Requires Action"&&a.aptitude?.score?`Aptitude: ${a.aptitude.score}/100`:r||"N/A"};return s.jsxs("div",{className:"candidate-card",children:[s.jsx("div",{className:"card-left-content",children:s.jsxs("div",{className:"candidate-info",children:[s.jsx("h3",{className:"candidate-name",children:i.full_name||i.name||"-"}),s.jsx("p",{className:"candidate-role",children:c(i.jobRole)||"-"})," ",s.jsx("p",{className:"candidate-domain",children:F(i.domain)||"-"})," ",s.jsxs("p",{className:"candidate-updated",children:["Last Updated: ",i.lastUpdated?new Date(i.lastUpdated).toLocaleDateString("en-GB"):"-"]}),i.job_matching&&s.jsxs("p",{className:"candidate-match",children:["Match:",s.jsxs("span",{className:`match-score ${i.job_matching.overall_match>=80?"high":i.job_matching.overall_match>=60?"medium":"low"}`,title:`Overall: ${i.job_matching.overall_match}%
Skills: ${i.job_matching.skill_match}%
Text Similarity: ${i.job_matching.text_similarity}%
Experience: ${i.job_matching.experience_match}%`,children:[i.job_matching.overall_match,"%"]})]})]})}),s.jsxs("div",{className:"card-right-actions",children:[s.jsx("div",{className:"candidate-status",children:s.jsx("span",{className:`status-badge ${v(i.status)}`,children:b(i)})}),s.jsx("button",{className:"view-details-btn",onClick:()=>f(i.id),children:"View Details"})]})]})},Ae=()=>{const i=be(),f=je(),F=ge(),c=h(e=>e.candidates.allCandidates),v=h(e=>e.candidates.candidatesStatus),b=h(e=>e.candidates.candidatesError),a=h(e=>e.jobs.allJobs||[]),r=h(e=>e.jobs.domains||[]),C=h(e=>e.jobs.jobsStatus),N=h(e=>e.jobs.domainsStatus),L=h(e=>e.search.searchTerm),[j,W]=o.useState({domain:"",jobRole:"",poc:"",minWorkExperience:"",status:""}),[k,Y]=o.useState("All"),[m,Q]=o.useState({domain:"",jobRole:"",poc:"",minWorkExperience:"",status:""}),[z,K]=o.useState("All"),[$]=o.useState(10),[g,O]=o.useState(1),[S,ne]=o.useState(!1),[B,M]=o.useState(!1),J=o.useRef(null),[U,ie]=o.useState(!1),le=()=>{ie(!U)};o.useEffect(()=>{const e=t=>{J.current&&!J.current.contains(t.target)&&M(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),o.useEffect(()=>{C==="idle"&&f(xe()),N==="idle"&&f(ve()),v==="idle"&&C!=="loading"&&N!=="loading"&&f(Ce())},[f,v,C,N]),o.useEffect(()=>{b&&F.error(`Error loading candidates: ${b}`)},[b,F]);const E=e=>{if(typeof e=="string"&&!/^[0-9]+$/.test(e))return e;const t=r.find(n=>String(n.id)===String(e));return t?t.name:e||"N/A"},w=e=>{if(typeof e=="string"&&!/^[0-9]+$/.test(e))return e;const t=a.find(n=>String(n.id)===String(e));return t?t.job_title:e||"N/A"},oe=o.useMemo(()=>{const e=new Set(c.map(t=>t.domain).filter(Boolean));return Array.from(e).map(t=>({id:t,name:E(t)})).sort((t,n)=>t.name.localeCompare(n.name))},[c,r]),re=o.useMemo(()=>{const e=new Set(c.map(t=>t.jobRole).filter(Boolean));return Array.from(e).map(t=>({id:t,title:w(t)})).sort((t,n)=>t.title.localeCompare(n.title))},[c,a]),ce=o.useMemo(()=>{const e=new Set(c.map(t=>t.poc).filter(Boolean));return Array.from(e).sort()},[c]),de=o.useMemo(()=>{const e=new Set(c.map(t=>x[t.status]||t.status).filter(Boolean));return Array.from(e).sort()},[c]),R=e=>{const{name:t,value:n}=e.target;W(p=>({...p,[t]:n}))},X=e=>{Y(e),W(t=>({...t,status:e==="All"?"":e}))},me=()=>{Q(j),K(k),O(1)},ue=()=>{W({domain:"",jobRole:"",poc:"",minWorkExperience:"",status:""}),Y("All"),Q({domain:"",jobRole:"",poc:"",minWorkExperience:"",status:""}),K("All"),O(1)},he=e=>{i(`/candidates/${e}`)},V=[...c.filter(e=>{L&&L.toLowerCase(),(e.full_name||e.name)&&(e.full_name||e.name).toLowerCase(),e.email&&e.email.toLowerCase(),E(e.domain)&&E(e.domain).toLowerCase(),w(e.jobRole)&&w(e.jobRole).toLowerCase();const t=e.poc?e.poc.toLowerCase():"",n=x[e.status]||e.status,p=n?n.toLowerCase():"",_=z==="All"||p===z.toLowerCase(),I=m.domain===""||e.domain===parseInt(m.domain,10),H=m.jobRole===""||e.jobRole===parseInt(m.jobRole,10),d=m.poc===""||t===m.poc.toLowerCase(),P=m.status===""||p===m.status.toLowerCase(),G=m.minWorkExperience===""||e.workExperience!==null&&e.workExperience>=parseInt(m.minWorkExperience,10);return _&&I&&H&&d&&G&&P})].sort((e,t)=>{if(L){const n=L.toLowerCase(),p=H=>{let d=0;const P=(G,fe="")=>{Object.entries(G||{}).forEach(([T,l])=>{if(l==null)return;let D;if(typeof l=="object"&&l!==null){P(l,`${fe}${T}.`);return}else typeof l=="boolean"?D=l?"true":"false":typeof l=="number"?D=String(l):l instanceof Date?D=l.toLocaleDateString():D=String(l);if(T==="domain"&&typeof l=="number"){const u=E(l);if(u){const A=u.toLowerCase();A.includes(n)&&(A.startsWith(n)?d+=10:d+=5)}}if(T==="jobRole"&&typeof l=="number"){const u=w(l);if(u){const A=u.toLowerCase();A.includes(n)&&(A.startsWith(n)?d+=10:d+=5)}}if(T==="status"&&x[l]){const u=x[l].toLowerCase();u.includes(n)&&(u.startsWith(n)?d+=10:d+=5)}const te=D.toLowerCase();te.includes(n)&&(te.startsWith(n)?d+=10:d+=5)})};return P(H),d},_=p(e),I=p(t);if(_!==I)return I-_}return 0}),Z=g*$,pe=Z-$,ee=V.slice(pe,Z),se=Math.ceil(V.length/$),q=e=>O(e);return s.jsxs("div",{className:"candidate-page-wrapper",children:[s.jsxs("div",{className:"mobile-controls-row",children:[s.jsxs("div",{className:"mobile-status-dropdown",ref:J,children:[s.jsxs("button",{className:"status-dropdown-button",onClick:()=>M(!B),children:[s.jsx("span",{className:"dropdown-selected-text",children:k}),s.jsx(Ne,{className:`dropdown-icon ${B?"open":""}`})]}),B&&s.jsx("div",{className:"status-dropdown-menu",children:ae.map(e=>s.jsx("button",{className:`status-dropdown-item ${k===e?"active":""}`,onClick:()=>{X(e),M(!1)},children:e},e))})]}),s.jsx("div",{className:"mobile-filter-toggle",children:s.jsxs("button",{className:`mobile-filter-btn ${S?"filter-open":""}`,onClick:()=>ne(!S),children:[s.jsx("span",{className:"btn-icon",children:S?"×":"⚙"}),s.jsx("span",{className:"btn-text",children:S?"Close":"Filter"})]})})]}),s.jsxs("div",{className:"candidates-main-content fixed-grid",children:[s.jsxs("div",{className:`filter-sidebar-section card slide-in-left ${S?"mobile-filter-visible":"mobile-filter-hidden"}`,children:[s.jsxs("div",{className:"filter-header",children:[s.jsx("h3",{children:"Filters"}),s.jsx("button",{className:"clear-filters",onClick:ue,children:"Clear Filters"})]}),s.jsxs("div",{className:"form-box",children:[s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{htmlFor:"domainFilter",children:"Domain"}),s.jsx(y,{value:String(j.domain),options:[{value:"",label:"All Domains"},...oe.map(e=>({value:String(e.id),label:e.name}))],onChange:e=>R({target:{name:"domain",value:e}}),placeholder:"All Domains",disabled:N==="loading"})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{htmlFor:"jobRoleFilter",children:"Job Role"}),s.jsx(y,{value:String(j.jobRole),options:[{value:"",label:"All Job Roles"},...re.map(e=>({value:String(e.id),label:e.title}))],onChange:e=>R({target:{name:"jobRole",value:e}}),placeholder:"All Job Roles",disabled:C==="loading"})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{htmlFor:"pocFilter",children:"POC"}),s.jsx(y,{value:j.poc,options:[{value:"",label:"All POCs"},...ce.map(e=>({value:e,label:e}))],onChange:e=>R({target:{name:"poc",value:e}}),placeholder:"All POCs"})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{htmlFor:"minWorkExperienceFilter",children:"Min. Work Experience (Years)"}),s.jsx("input",{type:"number",id:"minWorkExperienceFilter",name:"minWorkExperience",placeholder:"e.g., 5",value:j.minWorkExperience,onChange:R,className:"add-candidates-input",min:"0"})]}),s.jsxs("div",{className:"filter-group",children:[s.jsx("label",{htmlFor:"statusFilter",children:"Status"}),s.jsx(y,{value:j.status,options:[{value:"",label:"All Statuses"},...de.map(e=>({value:e,label:e}))],onChange:e=>R({target:{name:"status",value:e}}),placeholder:"All Statuses"})]})]}),s.jsx("div",{className:"form-actions",children:s.jsx("button",{className:"submit-btn",onClick:me,children:"Apply Filters"})})]}),s.jsxs("div",{className:"candidate-details-section card slide-in-right",children:[s.jsxs("div",{className:"candidate-status-tabs-container desktop-only",children:[s.jsxs("div",{className:"status-tabs-header",children:[s.jsx("h3",{className:"status-tabs-title",children:"Status Filters"}),s.jsx("button",{className:"edit-tabs-btn",onClick:le,title:U?"Exit Edit Mode":"Edit Status Tabs",children:U?"Done":"Edit"})]}),s.jsx("div",{className:"status-tabs-list",children:ae.map(e=>s.jsx("div",{className:`status-tab ${k===e?"active":""}`,onClick:()=>X(e),children:e},e))})]}),s.jsx("h2",{className:"section-title",children:"Candidate List"}),s.jsx("div",{className:"candidate-cards-container",children:s.jsx("div",{className:"candidate-list",children:v==="loading"||C==="loading"||N==="loading"?s.jsxs("div",{className:"loading-container",children:[s.jsx("div",{className:"loading-spinner"}),s.jsx("p",{children:"Loading candidates..."})]}):b?s.jsx("p",{children:"Unable to load candidates. Please refresh the page."}):ee.length>0?ee.map(e=>s.jsx(Se,{candidate:e,onViewReport:he,getDomainName:E,getJobTitle:w},e.id)):s.jsx("p",{className:"no-results",children:"No Candidates Found Matching Your Filters."})})}),V.length>$&&s.jsxs("div",{className:"candidates-pagination-container",children:[s.jsx("button",{onClick:()=>q(g-1),disabled:g===1,className:"candidates-pagination-button",title:"Previous page",children:"‹"}),Array.from({length:se},(e,t)=>s.jsx("button",{onClick:()=>q(t+1),className:`candidates-pagination-button ${g===t+1?"active":""}`,children:t+1},t+1)),s.jsx("button",{onClick:()=>q(g+1),disabled:g===se,className:"candidates-pagination-button",title:"Next page",children:"›"})]})]})]})]})};export{Ae as default};
