import{r as n,h as j,i as f,P as w,j as e,ac as y,ad as N,L as v,_ as S,ae as E,U as L,V as P,$ as k}from"./index-DasKWjZg.js";const C=({onLogin:u})=>{const[d,p]=n.useState(""),[c,g]=n.useState(""),[s,h]=n.useState(!1),[r,m]=n.useState(!1);j();const t=f(),o=w(),x=()=>{m(!r)},b=async i=>{if(i.preventDefault(),h(!0),!d||!c){o.error("Please enter both email and password."),h(!1);return}try{const l=await fetch(`${S}/api/auth/login/`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:d,password:c})});if(l.ok){const a=await l.json();localStorage.setItem("authToken",a.token),localStorage.setItem("userData",JSON.stringify(a.user)),t(E(a.user)),t(L()),t(P()),t(k()),u&&u(a.user),o.success("Successfully logged in! Welcome back.")}else{const a=await l.json();o.error(a.detail||"Invalid email or password. Please try again.")}}catch{o.error("An error occurred. Please try again later.")}finally{h(!1)}};return e.jsx("div",{className:"login-container",children:e.jsxs("div",{className:"login-card",children:[e.jsx("h2",{className:"login-title",children:"Login to Talaro"}),e.jsxs("form",{onSubmit:b,className:"login-form",role:"form","aria-label":"Login form",children:[e.jsxs("div",{className:"login-form-group",children:[e.jsx("label",{htmlFor:"email",children:"Email"}),e.jsx("input",{type:"email",id:"email",value:d,onChange:i=>p(i.target.value),placeholder:"Enter your email",required:!0,disabled:s,"aria-label":"Email address","aria-describedby":"email-help"}),e.jsx("div",{id:"email-help",className:"sr-only",children:"Enter your registered email address"})]}),e.jsxs("div",{className:"login-form-group",children:[e.jsx("label",{htmlFor:"password",children:"Password"}),e.jsxs("div",{className:"password-input-container",children:[e.jsx("input",{type:r?"text":"password",id:"password",value:c,onChange:i=>g(i.target.value),placeholder:"Enter your password",required:!0,disabled:s,className:"password-input","aria-label":"Password","aria-describedby":"password-help"}),e.jsx("button",{type:"button",className:"password-toggle-btn",onClick:x,disabled:s,tabIndex:-1,"aria-label":r?"Hide password":"Show password","aria-pressed":r,children:r?e.jsx(y,{size:20,"aria-hidden":"true"}):e.jsx(N,{size:20,"aria-hidden":"true"})})]}),e.jsx("div",{id:"password-help",className:"sr-only",children:"Enter your password"})]}),e.jsx("button",{type:"submit",className:"login-button",disabled:s,"aria-label":s?"Logging in, please wait":"Login to your account",children:s?e.jsxs(e.Fragment,{children:["Logging in",e.jsxs("span",{className:"loading-dots","aria-hidden":"true",children:[e.jsx("span",{children:"."}),e.jsx("span",{children:"."}),e.jsx("span",{children:"."})]})]}):"Login"})]}),e.jsxs("p",{className:"login-link-text",children:["Don't have an account? ",e.jsx(v,{to:"/register",children:"Register here"})]})]})})};export{C as default};
