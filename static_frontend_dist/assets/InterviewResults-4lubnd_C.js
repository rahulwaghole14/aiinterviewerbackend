import{aB as C,h as R,r,_ as N,j as s,am as I}from"./index-DasKWjZg.js";import{y as $}from"./index-C68axRq4.js";const q=()=>{const{sessionId:t}=C();R();const[i,b]=r.useState(null),[c,p]=r.useState(null),[_,h]=r.useState(!0),[x,u]=r.useState(null),[a,l]=r.useState("overview");r.useEffect(()=>{j()},[t]);const j=async()=>{try{h(!0);const e=localStorage.getItem("authToken");if(!e){u("Authentication required");return}const n=await fetch(`${N}/interview_app/api/results/${t}/`,{headers:{Authorization:`Token ${e}`,"Content-Type":"application/json"}});if(!n.ok)throw new Error("Failed to fetch interview results");const A=await n.json();b(A);const v=await fetch(`${N}/interview_app/api/analytics/${t}/`,{headers:{Authorization:`Token ${e}`,"Content-Type":"application/json"}});if(v.ok){const S=await v.json();p(S)}}catch(e){console.error("Error fetching interview results:",e),u(e.message),$.error("Failed to load interview results")}finally{h(!1)}},d=e=>e==null?"N/A":`${e}/10`,o=e=>e==null?"#6c757d":e>=8?"#28a745":e>=6?"#ffc107":"#dc3545",m=e=>e?new Date(e).toLocaleString():"N/A",f=()=>s.jsxs("div",{className:"results-overview",children:[s.jsxs("div",{className:"candidate-info",children:[s.jsx("h2",{children:"Candidate Information"}),s.jsxs("div",{className:"info-grid",children:[s.jsxs("div",{className:"info-item",children:[s.jsx("label",{children:"Name:"}),s.jsx("span",{children:i.candidate_name})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("label",{children:"Email:"}),s.jsx("span",{children:i.candidate_email})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("label",{children:"Scheduled:"}),s.jsx("span",{children:m(i.scheduled_at)})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("label",{children:"Completed:"}),s.jsx("span",{children:m(i.completed_at)})]}),s.jsxs("div",{className:"info-item",children:[s.jsx("label",{children:"Status:"}),s.jsx("span",{className:`status-badge ${i.status.toLowerCase()}`,children:i.status})]})]})]}),s.jsxs("div",{className:"evaluation-scores",children:[s.jsx("h2",{children:"Evaluation Scores"}),s.jsxs("div",{className:"scores-grid",children:[s.jsxs("div",{className:"score-card",children:[s.jsx("h3",{children:"Resume Score"}),s.jsx("div",{className:"score-value",style:{color:o(i.resume_score)},children:d(i.resume_score)})]}),s.jsxs("div",{className:"score-card",children:[s.jsx("h3",{children:"Interview Answers"}),s.jsx("div",{className:"score-value",style:{color:o(i.answers_score)},children:d(i.answers_score)})]}),s.jsxs("div",{className:"score-card",children:[s.jsx("h3",{children:"Overall Performance"}),s.jsx("div",{className:"score-value",style:{color:o(i.overall_performance_score)},children:d(i.overall_performance_score)})]})]})]}),s.jsxs("div",{className:"session-metrics",children:[s.jsx("h2",{children:"Session Metrics"}),s.jsxs("div",{className:"metrics-grid",children:[s.jsxs("div",{className:"metric-item",children:[s.jsx("label",{children:"Total Questions:"}),s.jsx("span",{children:i.analytics.communication_metrics.total_questions})]}),s.jsxs("div",{className:"metric-item",children:[s.jsx("label",{children:"Answered Questions:"}),s.jsx("span",{children:i.analytics.communication_metrics.answered_questions})]}),s.jsxs("div",{className:"metric-item",children:[s.jsx("label",{children:"Code Submissions:"}),s.jsx("span",{children:i.analytics.communication_metrics.code_submissions})]}),s.jsxs("div",{className:"metric-item",children:[s.jsx("label",{children:"Proctoring Warnings:"}),s.jsx("span",{children:i.total_warnings})]})]})]})]}),w=()=>s.jsxs("div",{className:"questions-section",children:[s.jsx("h2",{children:"Questions & Answers"}),s.jsx("div",{className:"questions-list",children:i.questions.map((e,n)=>s.jsxs("div",{className:"question-item",children:[s.jsxs("div",{className:"question-header",children:[s.jsxs("span",{className:"question-number",children:["Q",n+1]}),s.jsx("span",{className:"question-type",children:e.question_type}),s.jsx("span",{className:"question-level",children:e.question_level})]}),s.jsx("div",{className:"question-text",children:e.question_text}),e.transcribed_answer?s.jsxs("div",{className:"answer-section",children:[s.jsx("h4",{children:"Answer:"}),s.jsx("p",{children:e.transcribed_answer}),s.jsxs("div",{className:"answer-metrics",children:[s.jsxs("span",{children:["Response Time: ",e.response_time_seconds,"s"]}),s.jsxs("span",{children:["Words per minute: ",e.words_per_minute]}),s.jsxs("span",{children:["Filler words: ",e.filler_word_count]})]})]}):s.jsx("div",{className:"no-answer",children:"No answer provided"})]},e.id))})]}),g=()=>s.jsxs("div",{className:"code-submissions-section",children:[s.jsx("h2",{children:"Code Submissions"}),i.code_submissions.length>0?s.jsx("div",{className:"code-submissions-list",children:i.code_submissions.map((e,n)=>s.jsxs("div",{className:"code-submission-item",children:[s.jsxs("div",{className:"submission-header",children:[s.jsxs("span",{className:"submission-number",children:["Submission ",n+1]}),s.jsx("span",{className:"language-badge",children:e.language}),s.jsx("span",{className:"submission-time",children:m(e.submitted_at)})]}),s.jsxs("div",{className:"code-content",children:[s.jsx("h4",{children:"Submitted Code:"}),s.jsx("pre",{className:"code-block",children:e.submitted_code})]}),e.output_log&&s.jsxs("div",{className:"output-content",children:[s.jsx("h4",{children:"Output:"}),s.jsx("pre",{className:"output-block",children:e.output_log})]})]},e.id))}):s.jsx("div",{className:"no-submissions",children:"No code submissions found"})]}),y=()=>s.jsxs("div",{className:"analytics-section",children:[s.jsx("h2",{children:"Detailed Analytics"}),c&&s.jsxs("div",{className:"analytics-content",children:[s.jsxs("div",{className:"communication-metrics",children:[s.jsx("h3",{children:"Communication Metrics"}),s.jsxs("div",{className:"metrics-grid",children:[s.jsxs("div",{className:"metric-card",children:[s.jsx("label",{children:"Average Words per Minute"}),s.jsx("span",{children:c.communication_metrics.avg_words_per_minute})]}),s.jsxs("div",{className:"metric-card",children:[s.jsx("label",{children:"Total Filler Words"}),s.jsx("span",{children:c.communication_metrics.total_filler_words})]}),s.jsxs("div",{className:"metric-card",children:[s.jsx("label",{children:"Average Response Time"}),s.jsxs("span",{children:[c.communication_metrics.avg_response_time,"s"]})]}),s.jsxs("div",{className:"metric-card",children:[s.jsx("label",{children:"Average Sentiment Score"}),s.jsx("span",{children:c.communication_metrics.avg_sentiment_score})]})]})]}),c.proctoring_analytics.total_warnings>0&&s.jsxs("div",{className:"proctoring-analytics",children:[s.jsx("h3",{children:"Proctoring Analytics"}),s.jsx("div",{className:"warnings-list",children:Object.entries(c.proctoring_analytics.warning_counts).map(([e,n])=>s.jsxs("div",{className:"warning-item",children:[s.jsx("span",{className:"warning-type",children:e}),s.jsx("span",{className:"warning-count",children:n})]},e))})]})]})]}),k=()=>s.jsxs("div",{className:"feedback-section",children:[s.jsx("h2",{children:"AI Evaluation Feedback"}),s.jsxs("div",{className:"feedback-content",children:[i.resume_feedback&&s.jsxs("div",{className:"feedback-item",children:[s.jsx("h3",{children:"Resume Evaluation"}),s.jsx("div",{className:"feedback-text",children:i.resume_feedback})]}),i.answers_feedback&&s.jsxs("div",{className:"feedback-item",children:[s.jsx("h3",{children:"Interview Answers Evaluation"}),s.jsx("div",{className:"feedback-text",children:i.answers_feedback})]}),i.overall_performance_feedback&&s.jsxs("div",{className:"feedback-item",children:[s.jsx("h3",{children:"Overall Performance Assessment"}),s.jsx("div",{className:"feedback-text",children:i.overall_performance_feedback})]}),i.behavioral_analysis&&s.jsxs("div",{className:"feedback-item",children:[s.jsx("h3",{children:"Behavioral Analysis"}),s.jsx("div",{className:"feedback-text",children:i.behavioral_analysis})]}),i.keyword_analysis&&s.jsxs("div",{className:"feedback-item",children:[s.jsx("h3",{children:"Keyword Analysis"}),s.jsx("div",{className:"feedback-text",children:i.keyword_analysis})]})]})]});return _?s.jsx("div",{className:"interview-results",children:s.jsxs("div",{className:"loading-container",children:[s.jsx(I,{color:"var(--color-primary)",size:15}),s.jsx("h2",{children:"Loading Interview Results..."})]})}):x?s.jsx("div",{className:"interview-results",children:s.jsxs("div",{className:"error-container",children:[s.jsx("div",{className:"error-icon",children:"⚠️"}),s.jsx("h2",{children:"Error Loading Results"}),s.jsx("p",{children:x}),s.jsx("button",{className:"retry-button",onClick:j,children:"Retry"})]})}):i?s.jsxs("div",{className:"interview-results",children:[s.jsxs("div",{className:"results-header",children:[s.jsx("h1",{children:"Interview Results"}),s.jsxs("p",{children:["Session ID: ",t]})]}),s.jsxs("div",{className:"results-tabs",children:[s.jsx("button",{className:`tab-button ${a==="overview"?"active":""}`,onClick:()=>l("overview"),children:"Overview"}),s.jsx("button",{className:`tab-button ${a==="questions"?"active":""}`,onClick:()=>l("questions"),children:"Questions & Answers"}),s.jsx("button",{className:`tab-button ${a==="code"?"active":""}`,onClick:()=>l("code"),children:"Code Submissions"}),s.jsx("button",{className:`tab-button ${a==="analytics"?"active":""}`,onClick:()=>l("analytics"),children:"Analytics"}),s.jsx("button",{className:`tab-button ${a==="feedback"?"active":""}`,onClick:()=>l("feedback"),children:"AI Feedback"})]}),s.jsxs("div",{className:"results-content",children:[a==="overview"&&f(),a==="questions"&&w(),a==="code"&&g(),a==="analytics"&&y(),a==="feedback"&&k()]})]}):s.jsx("div",{className:"interview-results",children:s.jsxs("div",{className:"no-results",children:[s.jsx("h2",{children:"No Results Found"}),s.jsx("p",{children:"Interview results could not be found."})]})})};export{q as default};
